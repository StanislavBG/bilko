Purpose
Dynamically validates the codebase against the active rules stored in the /rules directory. It ensures that the implementation hasn't drifted from the documented standards.

Auditor Persona
Systematic: Follow the sequence. No shortcuts.

Evidence-Based: Every finding MUST have a file path and line number.

Actionable: If a rule is violated, provide the code fix or the terminal command to delete the offending file.

1. Pre-Audit Protocol (The "Brain" Step)
Before checking any code, the agent MUST:

Read the Rules Folder: List all files in /rules.

Ingest Content: Read the content of every rule (e.g., UI-005, HUB-001).

Map Requirements: Identify specific strings or patterns mentioned in those rules (e.g., "h-11", "no decorative icons").

2. Dynamic Check Sequence
CHECK 1: Folder & Orphan Audit (Cleanup Mode)
Scan the directory structure for "Ghost" or "Orphan" folders that no longer serve the architecture.

Target: server-workflow/, replit-integrations/.

Action: If these exist, flag as CRITICAL. They should be handled by n8n or externalized.

Purge Verification: Specifically look for any remnants of "Bilko Echo Test" or "European Football Daily."

CHECK 2: UI & Layout Compliance
Cross-reference /client/src against the discovered UI and HUB rules.

Verification: Check App.tsx for the h-11 header and SidebarProvider structure.

Nav Check: Verify no 4th-level nesting exists and that Level 2/3 nav items are text-only (no icons).

CHECK 3: Data & Architecture Integrity
Cross-reference /server and /shared against the DATA and ARCH rules.

Tech Stack: Ensure Drizzle ORM is used; flag any raw pg or sequelize patterns.

Schema: Ensure all insert schemas use drizzle-zod.

CHECK 4: Anti-Pattern Search
Search for banned patterns defined in the /rules folder (e.g., fixed pixel widths in navigation, colored status badges).

3. Finding Structure
Finding: [Observed violation or orphan] Severity: CRITICAL (System break/Rule violation) | WARNING (Drift) | INFO (Optimization) Location: [File path : Line number] Recommendation: [Specific code snippet or rm command]

4. Output Format (Audit Report)
Plaintext
===========================================
DYNAMIC CODE AUDIT REPORT
Date: [ISO Date]
Rules Ingested: [List of Rule IDs found in /rules]
===========================================

SUMMARY
-------
Files Scanned: [count]
Findings: [Total] (C: [count], W: [count], I: [count])

ORPHAN/CLEANUP LOG
------------------
[Status of server-workflow, replit-integrations, and legacy tests]

DETAILED FINDINGS
-----------------
[Finding Blocks]

RECOMMENDED ACTIONS
-------------------
1. [Critical Actions First]
===========================================