{
  "$schema": "./manifest.schema.json",
  "version": "3.0.0",
  "lastUpdated": "2026-02-09T00:00:00Z",
  "bootstrap": {
    "_instruction": "AI developers: READ ALL RULES in the /rules/ directory. This manifest indexes them for routing, but you must read the actual .md files.",
    "primaryDirective": "ARCH-000",
    "readingOrder": [
      "rules/architecture/000-primary-directive.md",
      "rules/architecture/002-agent-protocol.md"
    ],
    "preferences": {
      "pacing": "Move slowly, verify before building",
      "philosophy": "Rules-first, no over-building",
      "automation": "Never ask user to manually modify systems"
    },
    "stack": {
      "frontend": "React + Tailwind + Shadcn",
      "backend": "Express",
      "database": "PostgreSQL + Drizzle",
      "auth": "Replit Auth"
    }
  },
  "primaryDirective": "ARCH-000",
  "rules": {
    "ARCH-000": {
      "id": "ARCH-000",
      "title": "Primary Directive: Rules-First Development",
      "path": "rules/architecture/000-primary-directive.md",
      "partition": "architecture",
      "priority": "ABSOLUTE",
      "version": "3.0.0",
      "triggers": [
        "*",
        "orchestrat",
        "external",
        "proxy",
        "trace",
        "headless",
        "api-first",
        "programmatic",
        "auto-sync",
        "automation"
      ],
      "dependencies": [],
      "crossReferences": [
        "ARCH-002",
        "ARCH-003",
        "INT-002"
      ],
      "description": "Primary directive with founding principles: Rules-First, Orchestrator Pattern, and Headless Operation."
    },
    "ARCH-001": {
      "id": "ARCH-001",
      "title": "System Overview — Dual-Layer AI Architecture",
      "path": "rules/architecture/001-system-overview.md",
      "partition": "architecture",
      "priority": "CRITICAL",
      "version": "2.0.0",
      "triggers": [
        "system",
        "overview",
        "purpose",
        "mission",
        "what is",
        "architecture",
        "llm",
        "gemini",
        "in-platform",
        "dual layer"
      ],
      "dependencies": [
        "ARCH-000"
      ],
      "crossReferences": [
        "ARCH-002",
        "ARCH-003"
      ],
      "description": "System overview including purpose, mission, and high-level architecture."
    },
    "ARCH-002": {
      "id": "ARCH-002",
      "title": "Agent Protocol",
      "path": "rules/architecture/002-agent-protocol.md",
      "partition": "architecture",
      "priority": "CRITICAL",
      "version": "1.0.0",
      "triggers": [
        "agent",
        "protocol",
        "bootstrap",
        "session start",
        "new session",
        "how to use rules",
        "exit",
        "complete",
        "finish",
        "done"
      ],
      "dependencies": [
        "ARCH-000"
      ],
      "crossReferences": [
        "ARCH-004"
      ],
      "description": "Agent bootstrap and exit protocols for AI developers using the rule system."
    },
    "ARCH-003": {
      "id": "ARCH-003",
      "title": "System Architecture",
      "path": "rules/architecture/003-system-architecture.md",
      "partition": "architecture",
      "priority": "CRITICAL",
      "version": "1.0.0",
      "triggers": [
        "orchestrat",
        "proxy",
        "external",
        "n8n",
        "api call",
        "trace",
        "logging",
        "dispatch",
        "boundary",
        "coordination",
        "ownership"
      ],
      "dependencies": [
        "ARCH-000",
        "ARCH-001"
      ],
      "crossReferences": [
        "DATA-002",
        "INT-002",
        "INT-003",
        "ARCH-007"
      ],
      "description": "System architecture including orchestration layer, agent coordination, and system boundaries."
    },
    "ARCH-004": {
      "id": "ARCH-004",
      "title": "Rule Maintenance",
      "path": "rules/architecture/004-rule-maintenance.md",
      "partition": "architecture",
      "priority": "CRITICAL",
      "version": "1.0.0",
      "triggers": [
        "rule",
        "rules",
        "modify rule",
        "create rule",
        "new rule",
        "update rule",
        "replit.md",
        "documentation"
      ],
      "dependencies": [
        "ARCH-000"
      ],
      "crossReferences": [
        "ARCH-002"
      ],
      "description": "How to create, modify, and version rules. Includes replit.md governance."
    },
    "ARCH-005": {
      "id": "ARCH-005",
      "title": "Flow Steel Frame",
      "path": "rules/architecture/005-flow-steel-frame.md",
      "partition": "architecture",
      "priority": "CRITICAL",
      "version": "2.0.0",
      "triggers": [
        "flow",
        "steel frame",
        "invariant",
        "DAG",
        "step type",
        "flow validation",
        "flow inspector",
        "flow registry",
        "flow definition",
        "step contract",
        "execution contract"
      ],
      "dependencies": [
        "ARCH-000",
        "ARCH-001"
      ],
      "crossReferences": [
        "PER-002",
        "APP-LANDING-001",
        "APP-CHAT-001"
      ],
      "description": "Non-negotiable structural invariants for all in-platform flows. Defines DAG rules, step type contracts, execution contracts, voice builder contract, and registration contract."
    },
    "ARCH-006": {
      "id": "ARCH-006",
      "title": "Content Block System",
      "path": "rules/architecture/006-content-blocks.md",
      "partition": "architecture",
      "priority": "CRITICAL",
      "version": "1.0.0",
      "triggers": [
        "content block",
        "block type",
        "block renderer",
        "agent result",
        "quiz block",
        "video block",
        "bilko persona",
        "bilko voice",
        "bilko tone",
        "AgentContentResult",
        "BlockSequence",
        "content-blocks"
      ],
      "dependencies": [
        "ARCH-000",
        "ARCH-001",
        "ARCH-005"
      ],
      "crossReferences": [
        "PER-002",
        "APP-LANDING-001"
      ],
      "description": "Content block vocabulary and Bilko persona system. Defines 15 typed block types agents produce and the canvas renders, plus context-aware educator voice."
    },
    "HUB-001": {
      "id": "HUB-001",
      "title": "Hub Layout",
      "path": "rules/hub/001-layout.md",
      "partition": "hub",
      "priority": "HIGH",
      "version": "1.4.0",
      "triggers": [
        "hub",
        "layout",
        "sidebar",
        "navigation",
        "shell",
        "header"
      ],
      "dependencies": [
        "ARCH-001",
        "UI-001"
      ],
      "crossReferences": [
        "UI-001",
        "ARCH-007"
      ],
      "description": "Defines the Application Hub shell layout structure."
    },
    "HUB-002": {
      "id": "HUB-002",
      "title": "Access Control",
      "path": "rules/hub/002-access-control.md",
      "partition": "hub",
      "priority": "HIGH",
      "version": "1.1.0",
      "triggers": [
        "access",
        "control",
        "role",
        "admin",
        "user",
        "permission",
        "auth"
      ],
      "dependencies": [
        "ARCH-001"
      ],
      "crossReferences": [],
      "description": "Defines how users are granted access to Hub applications."
    },
    "HUB-003": {
      "id": "HUB-003",
      "title": "Nested Navigation Pattern",
      "path": "rules/hub/003-nested-navigation.md",
      "partition": "hub",
      "priority": "HIGH",
      "version": "3.0.0",
      "triggers": [
        "nested nav",
        "secondary nav",
        "tertiary nav",
        "multi-level",
        "navigation levels",
        "collapse",
        "collapsible",
        "left nav",
        "tabs",
        "master detail",
        "two column",
        "secondary sidebar"
      ],
      "dependencies": [
        "HUB-001",
        "UI-001"
      ],
      "crossReferences": [
        "UI-006"
      ],
      "description": "Defines optional 2nd and 3rd level navigation within applications (max 3 levels). Includes header pinning, collapsible behavior, mobile collapse, and secondary navigation patterns (merged from UI-003)."
    },
    "HUB-004": {
      "id": "HUB-004",
      "title": "Unified Navigation",
      "path": "rules/hub/004-unified-navigation.md",
      "partition": "hub",
      "priority": "HIGH",
      "version": "1.0.0",
      "triggers": [
        "navigation",
        "NavItem",
        "sidebar nav",
        "drill-down",
        "nav stack",
        "navigation data",
        "unified nav"
      ],
      "dependencies": [
        "HUB-001",
        "UI-006"
      ],
      "crossReferences": [
        "UI-006",
        "HUB-003"
      ],
      "description": "Unified recursive NavItem interface for N-level navigation. Data-driven approach with stack-based mobile drill-down."
    },
    "UI-001": {
      "id": "UI-001",
      "title": "UI Principles",
      "path": "rules/ui/001-ui-principles.md",
      "partition": "ui",
      "priority": "HIGH",
      "version": "1.0.0",
      "triggers": [
        "ui",
        "interface",
        "component",
        "styling",
        "page",
        "user sees",
        "layout"
      ],
      "dependencies": [
        "ARCH-001"
      ],
      "crossReferences": [
        "HUB-001"
      ],
      "description": "Rules for building user interfaces."
    },
    "UI-002": {
      "id": "UI-002",
      "title": "Endpoint Info Pattern",
      "path": "rules/ui/002-endpoint-info.md",
      "partition": "ui",
      "priority": "HIGH",
      "version": "1.0.0",
      "triggers": [
        "endpoint",
        "info icon",
        "api source",
        "data source",
        "endpoint info"
      ],
      "dependencies": [
        "UI-001",
        "ARCH-001"
      ],
      "crossReferences": [],
      "description": "Pattern for displaying API endpoint metadata via info icons in UI sections."
    },
    "UI-005": {
      "id": "UI-005",
      "title": "Minimal Design Principles",
      "path": "rules/ui/005-minimal-design.md",
      "partition": "ui",
      "priority": "HIGH",
      "version": "1.3.0",
      "triggers": [
        "minimal",
        "design",
        "text-only",
        "no icons",
        "relative sizing",
        "black white",
        "clean"
      ],
      "dependencies": [
        "UI-001"
      ],
      "crossReferences": [
        "HUB-003",
        "UI-006"
      ],
      "description": "Minimal text-only aesthetic with relative sizing and no colored accents."
    },
    "UI-006": {
      "id": "UI-006",
      "title": "Mobile Layout",
      "path": "rules/ui/006-mobile-layout.md",
      "partition": "ui",
      "priority": "HIGH",
      "version": "1.3.0",
      "triggers": [
        "mobile",
        "responsive",
        "collapse",
        "touch",
        "breakpoint",
        "on the go",
        "small screen",
        "carousel",
        "swipe",
        "drill-down"
      ],
      "dependencies": [
        "UI-001",
        "HUB-001",
        "HUB-003"
      ],
      "crossReferences": [
        "UI-005",
        "HUB-003",
        "APP-WORKFLOWS-001"
      ],
      "description": "Mobile-responsive layout with collapsible navigation, drill-down sheets, and swipeable carousels."
    },
    "UI-007": {
      "id": "UI-007",
      "title": "Application Actions",
      "path": "rules/ui/007-application-actions.md",
      "partition": "ui",
      "priority": "HIGH",
      "version": "1.0.0",
      "triggers": [
        "action",
        "action bar",
        "new button",
        "actions",
        "toolbar"
      ],
      "dependencies": [
        "UI-001",
        "UI-005"
      ],
      "crossReferences": [
        "HUB-003"
      ],
      "description": "Consistent pattern for application-level actions separate from navigation."
    },
    "DATA-001": {
      "id": "DATA-001",
      "title": "Data Principles",
      "path": "rules/data/001-data-principles.md",
      "partition": "data",
      "priority": "HIGH",
      "version": "1.0.0",
      "triggers": [
        "data",
        "database",
        "schema",
        "model",
        "drizzle",
        "postgres",
        "table"
      ],
      "dependencies": [
        "ARCH-001"
      ],
      "crossReferences": [],
      "description": "Rules for data models, schemas, and persistence."
    },
    "DATA-002": {
      "id": "DATA-002",
      "title": "Communication Trace Storage",
      "path": "rules/data/002-communication-traces.md",
      "partition": "data",
      "priority": "HIGH",
      "version": "1.2.0",
      "triggers": [
        "trace",
        "communication",
        "log",
        "request",
        "response",
        "storage",
        "execution",
        "userId",
        "error"
      ],
      "dependencies": [
        "DATA-001",
        "ARCH-003"
      ],
      "crossReferences": [
        "ARCH-003",
        "APP-MEMORY-001",
        "DATA-004"
      ],
      "description": "Schema and practices for storing communication traces with execution linkage and error tracking."
    },
    "DATA-003": {
      "id": "DATA-003",
      "title": "Rule Audit Storage",
      "path": "rules/data/003-rule-audits.md",
      "partition": "data",
      "priority": "HIGH",
      "version": "1.0.0",
      "triggers": [
        "rule audit",
        "audit storage",
        "audit table",
        "audit schema"
      ],
      "dependencies": [
        "DATA-001"
      ],
      "crossReferences": [
        "APP-RULES-001"
      ],
      "description": "Schema and practices for storing rule audit reports."
    },
    "DATA-004": {
      "id": "DATA-004",
      "title": "Callback Persistence Contract",
      "path": "rules/data/004-callback-persistence.md",
      "partition": "data",
      "priority": "HIGH",
      "version": "2.0.0",
      "triggers": [
        "callback",
        "persistence",
        "final output",
        "execution result",
        "workflow callback"
      ],
      "dependencies": [
        "INT-003",
        "DATA-002"
      ],
      "crossReferences": [
        "DATA-002",
        "ENV-001"
      ],
      "description": "Defines how n8n workflow callbacks persist execution results for distribution workflows. Migrated from INT-005."
    },
    "INT-002": {
      "id": "INT-002",
      "title": "n8n API Best Practices",
      "path": "rules/integration/n8n/002-api-practices.md",
      "partition": "integration",
      "priority": "HIGH",
      "version": "2.0.0",
      "triggers": [
        "n8n",
        "n8n api",
        "api key",
        "n8n cloud",
        "recency",
        "known issues",
        "webhook",
        "webhook bug",
        "headless",
        "webhook path",
        "single source of truth",
        "integration",
        "orchestrate",
        "orchestrator"
      ],
      "dependencies": [
        "ARCH-003"
      ],
      "crossReferences": [
        "ARCH-003",
        "INT-003",
        "ENV-004"
      ],
      "description": "PRIMARY n8n integration reference. Includes recency protocol, known issues registry, and all directives D1-D14."
    },
    "INT-003": {
      "id": "INT-003",
      "title": "Orchestrator Communication Contract",
      "path": "rules/integration/003-orchestrator-contract.md",
      "partition": "integration",
      "priority": "HIGH",
      "version": "2.1.0",
      "triggers": [
        "contract",
        "webhook",
        "request",
        "response",
        "payload",
        "format"
      ],
      "dependencies": [
        "ARCH-001",
        "ARCH-003"
      ],
      "crossReferences": [
        "ARCH-003",
        "INT-002",
        "ENV-001"
      ],
      "description": "Technical contract for orchestrator communication."
    },
    "APP-LANDING-001": {
      "id": "APP-LANDING-001",
      "title": "Landing Page — Agentic Discovery Experience",
      "path": "rules/apps/landing/001-overview.md",
      "partition": "apps",
      "priority": "HIGH",
      "version": "2.0.0",
      "triggers": [
        "landing",
        "public",
        "sign in",
        "login page",
        "unauthenticated",
        "video discovery",
        "voice command",
        "learning mode",
        "agentic flow",
        "welcome experience"
      ],
      "dependencies": [
        "ARCH-001"
      ],
      "crossReferences": [
        "PER-002"
      ],
      "description": "The public entry point with AI-powered, voice-enabled discovery experience. 6 learning modes, auto-starting AI flows, and voice navigation."
    },
    "APP-CHAT-001": {
      "id": "APP-CHAT-001",
      "title": "Conversation Experience — Multi-Agent Chat Canvas",
      "path": "rules/apps/chat/001-conversation-experience.md",
      "partition": "apps",
      "priority": "HIGH",
      "version": "2.0.0",
      "triggers": [
        "chat",
        "conversation",
        "bilko message",
        "agent voice",
        "speaker",
        "who is talking",
        "microphone",
        "mic",
        "voice settings",
        "agent handoff",
        "flow step",
        "chat widget",
        "conversation canvas",
        "multi-agent",
        "speaker label",
        "canvas contract"
      ],
      "dependencies": [
        "ARCH-005",
        "ARCH-006",
        "APP-LANDING-001"
      ],
      "crossReferences": [
        "ARCH-005",
        "ARCH-006",
        "APP-LANDING-001",
        "PER-002",
        "UI-005"
      ],
      "description": "Multi-agent conversation canvas contract. Speaker attribution, per-agent voices, mic-on default, no inline widgets, small text, flow step visibility, voice settings, and canvas interaction rules (merged from ARCH-005 C1-C4)."
    },
    "APP-MEMORY-001": {
      "id": "APP-MEMORY-001",
      "title": "Memory Explorer",
      "path": "rules/apps/memory-explorer/001-overview.md",
      "partition": "apps",
      "priority": "HIGH",
      "version": "1.0.0",
      "triggers": [
        "memory",
        "trace",
        "explorer",
        "communication history"
      ],
      "dependencies": [
        "DATA-002",
        "UI-001"
      ],
      "crossReferences": [
        "DATA-002"
      ],
      "description": "UI for viewing and inspecting communication traces."
    },
    "APP-WORKFLOWS-001": {
      "id": "APP-WORKFLOWS-001",
      "title": "N8N Workflows Page",
      "path": "rules/apps/agentic-workflows/001-overview.md",
      "partition": "apps",
      "priority": "HIGH",
      "version": "1.1.0",
      "triggers": [
        "workflow",
        "agentic",
        "n8n",
        "execution",
        "carousel",
        "drill-down",
        "nav stack"
      ],
      "dependencies": [
        "HUB-001",
        "UI-006",
        "DATA-002",
        "DATA-004"
      ],
      "crossReferences": [
        "UI-006",
        "DATA-004",
        "DATA-002",
        "HUB-003"
      ],
      "description": "N8N Workflows page with stack-based category/workflow navigation, execution history, and mobile carousel."
    },
    "APP-RULES-001": {
      "id": "APP-RULES-001",
      "title": "Rules Explorer",
      "path": "rules/apps/rules-explorer/001-overview.md",
      "partition": "apps",
      "priority": "HIGH",
      "version": "1.0.0",
      "triggers": [
        "rules explorer",
        "rule catalog",
        "rule viewer",
        "browse rules"
      ],
      "dependencies": [
        "HUB-001",
        "HUB-002",
        "HUB-003"
      ],
      "crossReferences": [
        "DATA-003"
      ],
      "description": "Admin-only app for browsing, reading, and auditing the rule system."
    },
    "ENV-001": {
      "id": "ENV-001",
      "title": "n8n Instance Configuration",
      "path": "rules/env/001-n8n-instance.md",
      "partition": "env",
      "priority": "CRITICAL",
      "version": "2.0.0",
      "triggers": [
        "n8n instance",
        "n8n url",
        "webhook base",
        "callback url",
        "replit url"
      ],
      "dependencies": [
        "ARCH-000"
      ],
      "crossReferences": [
        "ENV-002",
        "INT-002"
      ],
      "description": "n8n instance and Replit application URLs. No dev/prod separation."
    },
    "ENV-002": {
      "id": "ENV-002",
      "title": "n8n Workflow Registry",
      "path": "rules/env/002-n8n-workflow-registry.md",
      "partition": "env",
      "priority": "HIGH",
      "version": "2.0.0",
      "triggers": [
        "workflow registry",
        "workflow artifact",
        "n8n workflow",
        "workflow id"
      ],
      "dependencies": [
        "ENV-001"
      ],
      "crossReferences": [
        "ENV-001",
        "PER-001"
      ],
      "description": "Central registry of all n8n workflows with artifact paths."
    },
    "ARCH-007": {
      "id": "ARCH-007",
      "title": "Application Isolation",
      "path": "rules/architecture/007-application-isolation.md",
      "partition": "architecture",
      "priority": "CRITICAL",
      "version": "1.0.0",
      "triggers": [
        "isolation",
        "sandbox",
        "app boundary",
        "cross-app",
        "import boundary",
        "context scoping",
        "error boundary",
        "state firewall",
        "kill switch",
        "app independence",
        "spaghetti",
        "coupling",
        "provider",
        "god provider",
        "clean lifecycle",
        "app structure"
      ],
      "dependencies": [
        "ARCH-000",
        "ARCH-003",
        "HUB-001"
      ],
      "crossReferences": [
        "ARCH-005",
        "HUB-001",
        "HUB-002",
        "UI-001"
      ],
      "description": "Non-negotiable isolation invariants for applications. iPhone sandbox model: each app is independent, the hub survives any app failure, apps never import from each other."
    },
    "ENV-004": {
      "id": "ENV-004",
      "title": "n8n Self-Hosting Setup Guide",
      "path": "rules/env/004-n8n-setup.md",
      "partition": "env",
      "priority": "HIGH",
      "version": "2.0.0",
      "triggers": [
        "self-host",
        "n8n setup",
        "n8n project",
        "deploy n8n"
      ],
      "dependencies": [
        "ARCH-001"
      ],
      "crossReferences": [
        "INT-003",
        "INT-002"
      ],
      "description": "Complete setup guide for self-hosting n8n on Replit. Migrated from INT-004."
    }
  },
  "partitions": {
    "architecture": {
      "path": "rules/architecture/",
      "description": "System-wide architectural rules, principles, and cross-project coordination",
      "readOrder": 0
    },
    "hub": {
      "path": "rules/hub/",
      "description": "Application Hub shell and access control",
      "readOrder": 1
    },
    "ui": {
      "path": "rules/ui/",
      "description": "User interface patterns and components. Note: Individual UI components follow partition-level rules (UI-001) generically; component-specific rules are only created when patterns diverge significantly.",
      "readOrder": 2
    },
    "data": {
      "path": "rules/data/",
      "description": "Data model and persistence rules",
      "readOrder": 3
    },
    "apps": {
      "path": "rules/apps/",
      "description": "Per-application specific rules",
      "readOrder": 4
    },
    "integration": {
      "path": "rules/integration/",
      "description": "External service integration and cross-project contracts",
      "readOrder": 5
    },
    "env": {
      "path": "rules/env/",
      "description": "Environment configuration, workflow artifacts, and channel registry",
      "readOrder": 7
    }
  },
  "routing": {
    "redFlags": [
      {
        "pattern": "n8n|stripe|external service|webhook|integration",
        "partitions": [
          "integration"
        ]
      },
      {
        "pattern": "database|table|schema|migrate|trace|storage|persistence",
        "partitions": [
          "data"
        ]
      },
      {
        "pattern": "user sees|layout|page|component|mobile|responsive|minimal|design",
        "partitions": [
          "ui"
        ]
      },
      {
        "pattern": "hub|sidebar|navigation|access control|nested nav",
        "partitions": [
          "hub"
        ]
      },
      {
        "pattern": "endpoint|api route|authentication|principle|pacing|architecture|rule",
        "partitions": [
          "architecture"
        ]
      },
      {
        "pattern": "home|dashboard|landing|workflow page|memory explorer|new app|new feature",
        "partitions": [
          "apps",
          "architecture"
        ]
      },
      {
        "pattern": "agentic|llm|gemini|voice|speech|video discovery|learning mode|chat tutor|in-platform",
        "partitions": [
          "apps",
          "architecture"
        ]
      },
      {
        "pattern": "chat|conversation|microphone|mic|speaker|agent voice|who is talking|handoff|voice settings|canvas contract",
        "partitions": [
          "apps"
        ]
      },
      {
        "pattern": "flow|steel frame|DAG|step type|flow inspector|flow registry|flow definition|execution trace|step contract",
        "partitions": [
          "architecture"
        ]
      },
      {
        "pattern": "content block|block type|block renderer|agent result|bilko persona|bilko voice|bilko tone|quiz block|video block",
        "partitions": [
          "architecture"
        ]
      },
      {
        "pattern": "headless|auto-sync|programmatic|api-first|orchestrat",
        "partitions": [
          "architecture",
          "integration"
        ]
      },
      {
        "pattern": "isolation|sandbox|app boundary|cross-app|import boundary|coupling|spaghetti|context scoping|error boundary|kill switch",
        "partitions": [
          "architecture"
        ]
      },
      {
        "pattern": "environment|dev url|prod url|callback url|workflow artifact",
        "partitions": [
          "env"
        ]
      }
    ],
    "alwaysInclude": [
      "ARCH-000",
      "ARCH-002"
    ]
  }
}
